---
title: "SimpleStatisticalAnalysis"
author: "Xiaosong Zhang"
date: "9/18/2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
##1.What's your proudest achievement and why?
*It can be a personal project or something you've worked on professionally. Just a short paragraph is fine.*

This is a great question, and it really let me calm down and drive me to spend some time to think what are things I am truly caring and desire to do.

From my understanding, there are three types of things that I think could be considered as proud achievement:

- Self-improvement: Be able to complete difficult tasks through learning and practice. For example, build a computer from pieces of hardware for the first time; install and run my personal server or improve the performance of the code I wrote, etc. 

- Standing out in competition: Prepare and give a presentation that impresses the audiences better than my counterpart; Solve a given problem in a more efficient and elegant way, etc.

- Helping others overcome their obstacles: Tutor students and friends to not only getting understand the questions they cannot figure out but also try to locate the knowledge points they didn't know well which preventing them from figuring out the problem, etc.

So I think the proudest achievement of me should be able to fit in all those three categories. One of my recent achievement, which I believe can satisfy those should be that I independently instructed an Intro to Statistics class for 40 undergraduate students.

Volunteer to be an instructor is a tough decision to make, it requires much more enthusiasm, preparation time and stamina compare to teach regular recitation sessions. Even I know the last semester will extremely busy and pressure, I still decided to choose the hard way. I truly enjoying share my knowledge with others, many of my friends and sometimes my friends' friends come to me to seeking help with but not limited to academic problems. Sometimes I even wonder if the characteristics like this are inheritable because my grandparents from both sides are teachers and my father is a professor in Environmental Sciences, I must be somehow affected. 

I carefully prepared for and gave a trail lecture in front of professors and graduate students and been selected as one of top two candidates to teach the Intro to Stats course. 

During the semester I taught the course, I Carefully prepared for each lecture, provide and walk them through worksheets for every chapter, encourage them forming study groups and actively keeping touch with students' success coaches upon request. 

I closely keep tracking the performance of all my student, tried my best to give reasonable accommodations to help them keep on the right track. At the end of the semester, there is zero student withdraw from my session, and only one student failed -- who didn't show up and take the final exam.



##2. Tell us about a book or article related to data analysis you read recently, why you liked it, and why we should read it.

Cortez, Paulo, and Alice Maria Gon√ßalves Silva. "Using data mining to predict secondary school student performance." (2008).

I think the paper related to data analysis and also related to student performance prediction should be the **Using data mining to predict secondary school student performance** by Dr.Paulo Cortez is inspirational.

In this paper, the author analyzed the 33 attributes thought to be related to the secondary students' academic performance. The author uses not only commonly used regression methods but also use multiple different classification approaches(Might be inspired by Dr. Behrouz Minaei-Bidgoli from MSU).  

By transform the numerical final-grade variable into a categorical variable has only limited levels, Dr. Cortez successfully trained models based on Decision Trees (DT), Random Forests (RF), Neural Networks (NN) and Support Vector Machines(SVM) which can predict the student performance with a relatively high Percentage of Correct
Classifications (PCC) value, especially when the levels of the response variable had been reduced to binary. 

I think if the purpose of DIG is to build a system that could make a prediction whether a student need encourage, alert or may be intervention, those classification tools should be considered.




##3. Tell us about one aspect of the Digital Innovation Greenhouse you really like, and why.

From the materials that I read and watch, the DIG is trying very hard to help the student to became successful in their college life. In my opinion, the success in the undergraduate study is more depends on motivation, persistence other than intelligence. I believe everyone stepped on the campus were planning to graduate, but since we are human our ability to keep overcome unpredictable obstacles are limited continuously. The learning curve is not smooth for any student, and I would like to say it's constantly changing even in each and every course. I think the ECoach system along with the other systems makes by DIG are dedicated to detecting when a student is facing a steep segment of his/her learning curve and deliver the personalized help to help them defeat the peak and move on.

I would love to have some help like this when I was in college, even a fraction of it.

Besides the lofty goal of DIG, I also strongly attracted by the working environment(University) and colleagues of DIG. It's a great opportunity for me to work with and learn from those masterminds.

\pagebreak 

##4.STATS250 KEY FACTOR ANALYSIS

**Please answer the following question:  Other than GPAO, which variable(s) best predict the variable for GRD_PTS_PER_UNIT for the course STATS 250 (SUBJECT="STATS" and CATALOG_NBR=250)? In other words, what is the best predictor of a student's performance in STATS 250 other than the student's own GPA?**

###Conclusion 
Due to the limited time I have, I only tried the most simple linear models to test the data. 

lm(formula = GRD_PTS_PER_UNIT ~ HSGPA + LAST_ACT_COMP_SCORE + 
    LAST_ACT_MATH_SCORE + SEX, data = S.A.c)
    
The result shows that the p-value of HSGPA, LAST_ACT_COMP_SCORE, LAST_ACT_MATH_SCORE  and SEXM are all significant, but from the residual plot and Q-Q plot we can easily tell that the relationship is not linear.

If I have choose only the 'best' predictor, I would choose LAST_ACT_COMP_SCORE. 

And with the result of Lilliefors (Kolmogorov-Smirnov) test, none of those explanatory and response variables are normally distributed.

To train a better model to make a more accurate prediction, we might need to try GLM, GAM or maybe classification methods. Well, after cleaning the data properly.

I didn't look into those major, department and group data since there are too many missing data, I think I need more information to learn how to handle them correctly. 


###Data Import

```{r,message=FALSE,warning=FALSE}
require(nortest)
require("dplyr")
require("ggplot2")
require("rstudioapi")
require("ggthemes")
#set working directory to current .r file path
#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

#sourceDir is use to source all .r file under same Dir all in once
sourceDir <- function(path, trace = TRUE, ...) {
  for (nm in list.files(path, pattern = "[.][RrSsQq]$")) {
    if(trace) cat(nm,":")
    source(file.path(path, nm), ...)
    if(trace) cat("\n")
  }
}
#Source all functions uder PLA-MOOC into R-Environment for future use.
sourceDir('PLA-MOOC')
#loading data into Environment
# Start the clock!
ptm <- proc.time()
student.course <- read.csv("PLA-MOOC/student.course.csv")
proc.time() - ptm
ptm <- proc.time()
student.record <- read.csv("PLA-MOOC/student.record.csv")
proc.time() - ptm
```


###Data Exploration

Operations which creat to much unimportant output will not be run, but the code can still be find in the *STATS250 KEY FACTOR ANALYSIS.R* file

```{r,eval=TRUE}
names(student.record)
names(student.course)
# use summary(student.record) ;summary(student.course) to get a big picture of the data
summary(student.record$HSGPA)
```

HSGPA= 36? it most likely to be a error.
UM admit more than two thousands students with HSGPA 0?? or it should be NAs?

```{r}
# HSGPA= 36? it most likely to be a error
# UM admit students with HSGPA 0?? or it should be NAs?
filter(student.record, HSGPA>4.0)[,1:6]
# many of those who have HSGPA = 0 have LAST_ACT_MATH_SCORE close to Max 
# Cloud be a evidence their HSGPA should be NA instead of 0.
count(filter(student.record, HSGPA< 1 & LAST_ACT_MATH_SCORE >35 ))
```

Many of those who have HSGPA = 0 have LAST_ACT_MATH_SCORE close to Max. This cloud be a evidence their HSGPA should be NA instead of 0.

```{r}
#prepare data for dplyr
Course <-tbl_df(student.course)
Record <-tbl_df(student.record)

#getting to know the dataset's big picture
glimpse(Course)
glimpse(Record)
#names(Course)
#names(Record)
levels(Course$SUBJECT)
```

To manipulate large dataset, I would like to use dplyr since it's very fast(based on C++) and many operation similar to *SQL*.

```{r}
#select only the data required for look into STATS 250
STATS250 = filter(Course,SUBJECT =='STATS' & CATALOG_NBR == '250')
#aggregate the 'Record' and 'Course' table by the Anonymous ID
S.A = STATS250.Aggregate <- inner_join(STATS250,Record,by = 'ANONID')
attach(S.A)
#And we could write STATS250.Aggregate data to "SA.csv" which will save 
#alot of time if we want to focus on STATS250
write.table(S.A, file = "SA.csv")


#we can check the data use some basic commands
#Check
# glimpse(S.A)
# summary(S.A)
table(SEX)
qplot(HSGPA,colour = SEX,bins = 40,main = "High School GPA by gender")
```



```{r,warning=FALSE}
qplot(LAST_ACT_MATH_SCORE,colour = SEX,bins = 14,main = "Histogram for ACT MATH score by gender")
```

```{r}
p = ggplot(data = S.A, aes(y = LAST_SATI_MATH_SCORE, x = LAST_ACT_MATH_SCORE))
p + geom_point(aes(color = SEX)) +
  labs(title = "SAT MATH Vs. ACT MATH")+
  geom_smooth(method = "lm")+  theme_economist()
```



```{r}
#normality check before model fitting
lillie.test(LAST_ACT_MATH_SCORE)
lillie.test(HSGPA)
lillie.test(LAST_SATI_MATH_SCORE)
lillie.test(GRD_PTS_PER_UNIT)
```

```{r}
fit.SatVsAct <- lm(LAST_SATI_MATH_SCORE~LAST_ACT_MATH_SCORE) 
summary(fit.SatVsAct)

# these plot make pdf tooo big
#par(mfrow=c(2,2))
#plot(fit.SatVsAct)
```

There are `r count(filter(S.A, LAST_ACT_MATH_SCORE> 0 ))` students have ACT math score, `r count(filter(S.A, LAST_SATI_MATH_SCORE> 0 ))` students have SAT math score, but only `r count(filter(S.A, LAST_SATI_MATH_SCORE> 0 & LAST_ACT_MATH_SCORE> 0))` students have both. It will be a huge lose if we use both SAT and ACT math score as explanary variables.

Since we could find a strong correlation between SAT and ACT math score, we can use one to predict the other, or even calculate a mathematic ability score as a predictor. 

The paper Dorans, Neil J. "Correspondences between ACTT and SATÆ I scores." ETS Research Report Series 1999.1 (1999): i-18. gave a similar result on page 20.


```{r}
fit.GRD <- lm(data = S.A, GRD_PTS_PER_UNIT~HSGPA + LAST_ACT_MATH_SCORE+SEX)
summary(fit.GRD)
```

The $r^2$ is very low, I believe the wrongly placed 2000 '0's under HSGPA should be one of the reason. Let's **try to remove those HSGPA = 0**. This is not the best way to haddle this situation. Since we don't know what casued this error, it might be influce the result if the error were not happens randomly.

```{r}
# filter out those have HSGPA = 0 and ACT math = 0
S.A.c<- filter(S.A, HSGPA>0 & LAST_ACT_MATH_SCORE > 0)
fit.GRDc <- lm(data = S.A.c, GRD_PTS_PER_UNIT~HSGPA + LAST_ACT_MATH_SCORE+SEX)
summary(fit.GRDc)
#par(mfrow=c(2,2))
#plot(fit.GRDc)
```

```{r}

fit.GRDb <- lm(data = S.A.c, GRD_PTS_PER_UNIT~HSGPA +LAST_ACT_COMP_SCORE+ LAST_ACT_MATH_SCORE +SEX)
summary(fit.GRDb)
#par(mfrow=c(2,2))
#plot(fit.GRDb)
```

```{r}
fit.GRDe <- lm(data = S.A.c, GRD_PTS_PER_UNIT~LAST_ACT_COMP_SCORE);summary(fit.GRDe)
```

```{r}
fit.GRDf <- lm(data = S.A.c, GRD_PTS_PER_UNIT~HSGPA);summary(fit.GRDf)
```

```{r}
fit.GRDg <- lm(data = S.A.c, GRD_PTS_PER_UNIT~LAST_ACT_MATH_SCORE);summary(fit.GRDg)
```

```{r}
fit.GRDe <- lm(data = S.A.c, GRD_PTS_PER_UNIT~LAST_ACT_COMP_SCORE);summary(fit.GRDe)
```


